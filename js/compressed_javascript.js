function clear(a){var t,e=a.length;for(t=0;t<e;t++)a.pop()}function newGame(){clear(tableData),clear(bombData),createTableData(),declareNeighbor(),randomBomb(),generateTable(),getLocation(),updateDemo(),markdown(),gameEnd=!1,document.getElementById("tBoard").className="tableBoard",40===bombNumber&&alert("you reach to the max number of bomb.\n if you win your the man !")}function createTableData(){var a;for(a=0;a<100;a++)tableData.push({north:-1,northEast:-1,northWest:-1,south:-1,southEast:-1,southWest:-1,east:-1,west:-1,nearBomb:0,bomb:!1,checked:!1,clickable:!0,position:{row:0,cell:0}})}function declareNeighbor(){var a,t,e,o,l,b,n,r,s,c=tableData.length;for(a=0;a<c;a++)t=a-11,e=a-10,o=a-9,l=a+1,b=a+11,n=a+10,r=a+9,s=a-1,0===a?(tableData[a].east=l,tableData[a].southEast=b,tableData[a].south=n):a>0&&a<9?(tableData[a].east=l,tableData[a].southEast=b,tableData[a].south=n,tableData[a].southWest=r,tableData[a].west=s):9===a?(tableData[a].south=n,tableData[a].southWest=r,tableData[a].west=s):a%10==9&&9!=a&&99!=a?(tableData[a].south=n,tableData[a].southWest=r,tableData[a].west=s,tableData[a].northWest=t,tableData[a].north=e):99===a?(tableData[a].west=s,tableData[a].northWest=t,tableData[a].north=e):a%90>0&&a%90<9?(tableData[a].west=s,tableData[a].northWest=t,tableData[a].north=e,tableData[a].northEast=o,tableData[a].east=l):90===a?(tableData[a].north=e,tableData[a].northEast=o,tableData[a].east=l):a%10==0&&0!=a&&90!=a?(tableData[a].north=e,tableData[a].northEast=o,tableData[a].east=l,tableData[a].southEast=b,tableData[a].south=n):(tableData[a].northWest=t,tableData[a].north=e,tableData[a].northEast=o,tableData[a].east=l,tableData[a].southEast=b,tableData[a].south=n,tableData[a].southWest=r,tableData[a].west=s)}function randomBomb(){flag=0;for(var a;bombData.length<bombNumber;)!1===checkBomb(a=parseInt(100*Math.random()-1))&&(tableData[a].bomb=!0,bombData.push(a),WarningSign(a),flag++)}function checkBomb(a){var t;for(t=0;t<bombData.length;t++)if(a===bombData[t])return!0;return!1}function WarningSign(a){var t,e,o,l,b,n,r,s;t=tableData[a].northWest,e=tableData[a].north,o=tableData[a].northEast,l=tableData[a].east,b=tableData[a].southEast,n=tableData[a].south,r=tableData[a].southWest,s=tableData[a].west,-1!=t&&(tableData[t].nearBomb+=1),-1!=e&&(tableData[e].nearBomb+=1),-1!=o&&(tableData[o].nearBomb+=1),-1!=l&&(tableData[l].nearBomb+=1),-1!=b&&(tableData[b].nearBomb+=1),-1!=n&&(tableData[n].nearBomb+=1),-1!=r&&(tableData[r].nearBomb+=1),-1!=s&&(tableData[s].nearBomb+=1)}function generateTable(){var a,t,e,o=document.getElementById("tableFrame"),l=0;for(o.innerHTML="",a=0;a<10;a++)for(e=o.insertRow(a),t=0;t<10;t++)e.insertCell(t),tableData[l].position.row=a,tableData[l].position.cell=t,o.rows[a].cells[t].className="tCell",l++}function getLocation(a){$("td").click(function(){var a=document.getElementById("tableFrame"),t=$(this).parent().children().index($(this)),e=$(this).parent().parent().children().index($(this).parent()),o=10*e+t;if(!0!==gameEnd)return!1===tableData[o].clickable?(a.rows[e].cells[t].className="",tableData[o].clickable=!0,flag++,void updateDemo()):void(!1===gameEnd&&(checkRoom(o,!1),!0===checkForWin()&&(alert(" You Win The Game "),winRecord++,bombNumber<=39&&bombNumber++,updateDemo(),gameEnd=!0)))})}function checkRoom(a,t){var e=document.getElementById("tableFrame"),o=tableData[a].position.row,l=tableData[a].position.cell;if(-1!==a&&!0!==tableData[a].checked&&!1!==tableData[a].clickable){if(tableData[a].checked=!0,!0===tableData[a].bomb)return e.rows[o].cells[l].className="bomb",document.getElementById("tBoard").className+=" shakeDemo",showAllTable(),showBombs(-1),loseRecord++,updateDemo(),void(gameEnd=!0);(tableData[a].nearBomb>0||!0===t)&&!0===tableData[a].clickable&&(temp=tableData[a].nearBomb,e.rows[o].cells[l].className="checked",1===temp&&(e.rows[o].cells[l].innerHTML="<h3 class='roomNumber code_0'>"+temp+"</h3>"),temp>1&&temp<=3&&(e.rows[o].cells[l].innerHTML="<h3 class='roomNumber code_1'>"+temp+"</h3>"),temp>3&&(e.rows[o].cells[l].innerHTML="<h3 class='roomNumber code_2'>"+temp+"</h3>")),0===tableData[a].nearBomb&&(e.rows[o].cells[l].className+=" checked",-1!=tableData[a].northWest&&!1===tableData[tableData[a].northWest].checked&&checkRoom(tableData[a].northWest,!0),-1!=tableData[a].north&&!1===tableData[tableData[a].north].checked&&checkRoom(tableData[a].north,!0),-1!=tableData[a].northEast&&!1===tableData[tableData[a].northEast].checked&&checkRoom(tableData[a].northEast,!0),-1!=tableData[a].east&&!1===tableData[tableData[a].east].checked&&checkRoom(tableData[a].east,!0),-1!=tableData[a].southEast&&!1===tableData[tableData[a].southEast].checked&&checkRoom(tableData[a].southEast,!0),-1!=tableData[a].south&&!1===tableData[tableData[a].south].checked&&checkRoom(tableData[a].south,!0),-1!=tableData[a].southWest&&!1===tableData[tableData[a].southWest].checked&&checkRoom(tableData[a].southWest,!0),-1!=tableData[a].west&&!1===tableData[tableData[a].west].checked&&checkRoom(tableData[a].west,!0))}}function showBombs(a){if(-1===a&&(a=0),a!==bombData.length){var t=bombData[a],e=document.getElementById("tableFrame"),o=tableData[t].position.row,l=tableData[t].position.cell;e.rows[o].cells[l].className="bomb",a++,setTimeout(showBombs,5,a)}}function showAllTable(){var a,t,e,o=tableData.length,l=document.getElementById("tableFrame");for(document.getElementById("myAudio").play(),a=0;a<o;a++)if(t=tableData[a].position.row,e=tableData[a].position.cell,0===tableData[a].nearBomb&&(l.rows[t].cells[e].className="checked"),tableData[a].nearBomb>0&&!1===tableData[a].bomb){var b=tableData[a].nearBomb;l.rows[t].cells[e].className="checked",1===b&&(l.rows[t].cells[e].innerHTML="<h3 class='roomNumber code_0'>"+b+"</h3>"),b>1&&b<=3&&(l.rows[t].cells[e].innerHTML="<h3 class='roomNumber code_1'>"+b+"</h3>"),b>3&&(l.rows[t].cells[e].innerHTML="<h3 class='roomNumber code_2'>"+b+"</h3>")}}function checkForWin(){var a,t=tableData.length;for(a=0;a<t;a++)if(!1===tableData[a].checked&&!1===tableData[a].bomb)return!1;return!0}function markdown(){$("td").contextmenu(function(){if(!0!==gameEnd){var a=document.getElementById("tableFrame"),t=$(this).parent().children().index($(this)),e=$(this).parent().parent().children().index($(this).parent()),o=10*e+t;return flag>0&&!1===tableData[o].checked&&!0===tableData[o].clickable&&(tableData[o].clickable=!1,a.rows[e].cells[t].className="flag",flag--,updateDemo()),!1}})}function updateDemo(){document.getElementById("bombDemo").innerHTML=flag,document.getElementById("winDemo").innerHTML=winRecord,document.getElementById("loseDemo").innerHTML=loseRecord}var tableData=[],bombData=[],gameEnd=!1,winRecord=0,loseRecord=0,flag=0,bombNumber=10,level=1;window.onload=function(){createTableData(),declareNeighbor(),randomBomb(),generateTable(),getLocation(),markdown(),updateDemo()};